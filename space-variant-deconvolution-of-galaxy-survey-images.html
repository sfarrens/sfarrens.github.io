<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Space variant deconvolution of galaxy survey images Contents Point Spread Function Deconvolution Sparsity Low-Rank Approximation Results This post gives a brief summary of a paper I recently ...">
        <meta name="keywords" content="">
        <link rel="icon" href="/favicon.ico">

        <title>Space variant deconvolution of galaxy survey images - SF Space</title>

        <!-- Stylesheets -->
        <link href="/theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-88784993-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->


    </head>

    <body>

        <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('/images/lego.jpg'); background-position: center; background-size: cover;">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="/"><img class="mr20" src="/images/mythosaur.jpg" alt="logo" height="30">SF Space</a>
                    </div>
                    <div class="nav pull-right">
                            <a  href="/pages/about.html">About</a>
                            <a  href="/pages/cv.html">CV</a>
                            <a  href="/pages/publications.html">Publications</a>
                            <a  href="/pages/software.html">Software</a>
                            <a  href="/pages/tutorials.html">Tutorials</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Space variant deconvolution of galaxy survey images</h1>
                      <p class="header-date">By <a href="/author/samuel-farrens.html">Samuel Farrens</a>, Wed 08 March 2017, in category <a href="/category/science.html">Science</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <div class="section" id="id1">
<h2>Space variant deconvolution of galaxy survey images</h2>
<div class="contents local topic" id="contents">
<p class="topic-title first"><strong>Contents</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#point-spread-function" id="id2">Point Spread Function</a></li>
<li><a class="reference internal" href="#deconvolution" id="id3">Deconvolution</a></li>
<li><a class="reference internal" href="#sparsity" id="id4">Sparsity</a></li>
<li><a class="reference internal" href="#low-rank-approximation" id="id5">Low-Rank Approximation</a></li>
<li><a class="reference internal" href="#results" id="id6">Results</a></li>
</ul>
</div>
<p>This post gives a brief summary of a paper I recently submitted to A&amp;A, which
you can find <a href="https://arxiv.org/abs/1703.02305"
target="_blank">here</a>.</p>
<p>The Python code for performing deconvolution can be found <a href="https://github.com/sfarrens/psf_deconvolution"
target="_blank">here</a>.</p>
<div class="section" id="point-spread-function">
<h3><a class="toc-backref" href="#contents">Point Spread Function</a></h3>
<p>The Point Spread Function or PSF of an imaging system (also referred to as the
impulse response) describes how the system responds to a point (unextended)
source. In astrophysics, stars or quasars are often used to measure
the PSF of an instrument as in ideal conditions their light would occupy a
single pixel on a CCD. Telescopes, however, diffract the incoming photons which
limits the maximum resolution achievable. In reality, the images obtained from
telescopes include aberrations from various sources such as:</p>
<ul class="simple">
<li>The atmosphere (for ground based instruments)</li>
<li>Jitter (for space based instruments)</li>
<li>Imperfections in the optical system</li>
<li>Charge spread of the detectors</li>
</ul>
</div>
<div class="section" id="deconvolution">
<h3><a class="toc-backref" href="#contents">Deconvolution</a></h3>
<p>In order to recover the true image properties it is necessary to remove PSF
effects from observations. If the PSF is known (which is certainly not
trivial) one can attempt to deconvolve the PSF from the image. In the absence
of noise this is simple. We can model the observed image <span class="math">\(mathbf{y}\)</span> as
follows</p>
<div class="math">
\begin{equation*}
\mathbf{y} = \mathbf{H}\mathbf{x}
\end{equation*}
</div>
<p>where <span class="math">\(\mathbf{x}\)</span> is the true image and <span class="math">\(\mathbf{H}\)</span> is an
operator that represents the convolution with the PSF. Thus, to recover the
true image, one would simply invert <span class="math">\(\mathbf{H}\)</span> as follows</p>
<div class="math">
\begin{equation*}
\mathbf{x} = \mathbf{H}^{-1}\mathbf{y}
\end{equation*}
</div>
<p>Unfortunately, the images we observe also contain noise (<em>e.g.</em> from the CCD
readout) and this complicates the problem.</p>
<div class="math">
\begin{equation*}
\mathbf{y} = \mathbf{H}\mathbf{x} + \mathbf{n}
\end{equation*}
</div>
<p>This problem is ill-posed as even the tiniest amount of noise will have a large
impact on the result of the operation. Therefore, to obtain a stable and unique
solution, it is necessary to regularise the problem by adding additional prior
knowledge of the true images.</p>
</div>
<div class="section" id="sparsity">
<h3><a class="toc-backref" href="#contents">Sparsity</a></h3>
<p>One way to regularise the problem is using <strong>sparsity</strong>. The concept of
sparsity is quite simple. If we know that there is a representation of
<span class="math">\(\mathbf{x}\)</span> that is sparse (<em>i.e.</em> most of the coefficients are zeros)
then we can force our deconvolved observation <span class="math">\(\mathbf{\hat{x}}\)</span> to be
sparse in the same domain. In practice we aim to minimise a problem of the
following form</p>
<div class="math">
\begin{equation*}
\begin{aligned}
    &amp; \underset{\mathbf{x}}{\text{argmin}}
    &amp; \frac{1}{2}\|\mathbf{y}-\mathbf{H}\mathbf{x}\|_2^2 + \lambda\|\Phi(\mathbf{x})\|_1
    &amp; &amp; \text{s.t.}
    &amp; &amp; \mathbf{x} \ge 0
\end{aligned}
\end{equation*}
</div>
<p>where <span class="math">\(\Phi\)</span> is a matrix that transforms <span class="math">\(\mathbf{x}\)</span> to the sparse
domain and <span class="math">\(\lambda\)</span> is a regularisation control parameter.</p>
</div>
<div class="section" id="low-rank-approximation">
<h3><a class="toc-backref" href="#contents">Low-Rank Approximation</a></h3>
<p>Another way to regularise the problem is assume that all of the images one aims
to deconvolve live on a underlying low-rank manifold. In other words, if we
have a sample of galaxy images we wish to deconvolve then we can construct a
matrix <span class="math">\(\mathbf{X}\)</span> where each column is a vector of galaxy pixel
coefficients. If many of these galaxies have similar properties then we know
that <span class="math">\(\mathbf{X}\)</span> will have a smaller rank than if images were all very
different. We can use this knowledge to regularise the deconvolution problem
in the following way</p>
<div class="math">
\begin{equation*}
\begin{aligned}
    &amp; \underset{\mathbf{X}}{\text{argmin}}
    &amp; \frac{1}{2}\|\mathbf{Y}-\mathcal{H}(\mathbf{X})\|_2^2 + \lambda\|\mathbf{X}\|_*
    &amp; &amp; \text{s.t.}
    &amp; &amp; \mathbf{X} \ge 0
\end{aligned}
\end{equation*}
</div>
</div>
<div class="section" id="results">
<h3><a class="toc-backref" href="#contents">Results</a></h3>
<p>In the paper I implement both of these regularisation techniques and compare
how well they perform at deconvolving a sample of 10,000 Euclid-like galaxy
images. The results show that, for the data used, sparsity does a better job
at recovering the image pixels, while the low-rank approximation does a better
job a recovering the galaxy shapes (provided enough galaxies are used).</p>
<img alt="Median Pixel Error" class="align-center" src="images/pixel_error_10000_2_median.png" style="width: 600.0px; height: 400.0px;" />
<img alt="Median Ellipticity Error" class="align-center" src="images/ellipticity_error_10000_2_median.png" style="width: 600.0px; height: 400.0px;" />
</div>
</div>
<script type='text/javascript'>if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>


        
    </div>
        <!-- /Content -->

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="/categories.html">Categories</a></li>
                            <li><a href="/tags.html">Tags</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="https://twitter.com/Sam_Farrens" target="_blank">Twitter: @sam_farrens</a></li>
                            <li><a href="https://github.com/sfarrens" target="_blank">GitHub: sfarrens</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="http://www.cosmostat.org/" target="_blank">CosmoStat</a></li>
                            <li><a href="http://dedale.cosmostat.org/" target="_blank">DEDALE</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; SF Space 2016</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>